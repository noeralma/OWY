<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart Page</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>
  <body>
    <header class="header" id="header">
      <a href="index.html"
        ><img
          src="image/owy-high-resolution-logo-transparent (1).png"
          alt="OWY Logo"
      /></a>
      <nav>
        <ul class="navbar">
          <li><a class="active" href="index.html">Home</a></li>
          <li><a href="#products">Shop</a></li>
          <li><a href="#footer">About</a></li>
          <li>
            <a href="cart.html"
              ><i class="fa fa-shopping-basket" aria-hidden="true"></i
            ></a>
          </li>
          <a href="#" class="close"><i class="fa fa-times"></i></a>
        </ul>
      </nav>
      <div class="mobile">
        <i id="bar" class="fas fa-outdent"></i>
      </div>
    </header>

    <section id="cart" class="cart">
      <table width="100%">
        <thead>
          <tr>
            <td>Remove</td>
            <td>Image</td>
            <td>Product</td>
            <td>Price</td>
            <td>Quantity</td>
            <td>Subtotal</td>
          </tr>
        </thead>
        <tbody>
          <!-- Cart items will be dynamically inserted here -->
        </tbody>
      </table>
    </section>

    <section id="add-cart" class="add-cart">
      <div id="coupon">
        <h3>Apply Coupons</h3>
        <div>
          <input type="text" placeholder="Enter your coupons!" />
          <button class="button">Apply</button>
        </div>
      </div>
      <div id="subtotal">
        <h3>Total</h3>
        <table>
          <!-- Subtotal and total will be dynamically inserted here -->
        </table>
        <button class="button">Checkout</button>
      </div>
    </section>

    <section class="products" id="products">
      <div class="box">
        <h2>Products</h2>
        <p>Gifts For Your Beloved</p>
        <div class="container">
          <article class="card">
            <a href="product1.html">
              <img src="image/Music-Box-Peksi-Merak-S-03.jpg" alt="Music Box" />
              <div class="desc">
                <h5>Music Box</h5>
                <div class="rate">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
                <h4>Rp 250.000</h4>
              </div>
            </a>
          </article>
          <article class="card">
            <a href="product2.html">
              <img src="image/Preserve 1.jpg" alt="Preserved Flower" />
              <div class="desc">
                <h5>Preserved Flower</h5>
                <div class="rate">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
                <h4>Rp 150.000</h4>
              </div>
            </a>
          </article>
          <article class="card">
            <a href="product3.html">
              <img src="image/Stuffed 1.webp" alt="Giant Stuffed Bear" />
              <div class="desc">
                <h5>Giant Stuffed Bear</h5>
                <div class="rate">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
                <h4>Rp 100.000</h4>
              </div>
            </a>
          </article>
        </div>
      </div>
    </section>

    <footer class="footer" id="footer">
      <div class="column">
        <img
          class="logo"
          src="image/owy-high-resolution-logo-transparent (2).png"
          alt="OWY Logo"
        />
        <h4>Contact</h4>
        <p>
          <strong>Address:</strong> To The Moon Street, No. 28, Bandung,
          Indonesia
        </p>
        <p><strong>Phone:</strong> +62 815 7283 9183</p>
        <p><strong>Open Hours:</strong> 09.00-17.00</p>
        <div class="social">
          <h4>Our Socials</h4>
          <div class="icon">
            <a href="https://facebook.com" target="_blank"
              ><i class="fab fa-facebook-square"></i
            ></a>
            <a href="https://twitter.com" target="_blank"
              ><i class="fab fa-twitter"></i
            ></a>
            <a href="https://instagram.com" target="_blank"
              ><i class="fab fa-instagram"></i
            ></a>
          </div>
        </div>
      </div>

      <div class="column">
        <h4>My Account</h4>
        <a href="#">Sign In</a>
        <a href="#">Cart</a>
        <a href="#">My Orders</a>
        <a href="#">Help</a>
      </div>

      <div class="app">
        <h4>COMING SOON!</h4>
        <p>On App Store and Google Play</p>
        <div class="row">
          <img src="image/app.jpg" alt="App Store" />
          <img src="image/play.jpg" alt="Google Play" />
        </div>
        <p>Payment Methods</p>
        <img src="image/pay.png" alt="Payment Methods" />
      </div>
    </footer>

    <script src="script.js"></script>

    <script>
      function updateCart() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const cartTableBody = document.querySelector("#cart tbody");
        let subtotal = 0;

        cartTableBody.innerHTML = ""; // Clear existing rows

        cart.forEach((item, index) => {
          const total = item.price * item.quantity;

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><a href="#" class="delete-row" data-index="${index}"><i class="far fa-times-circle"></i></a></td>
            <td><img src="${item.image}" width="70px" alt="${
            item.productType
          }" /></td>
            <td>${item.productType}</td>
            <td>Rp ${item.price.toLocaleString()}</td>
            <td><input type="number" value="${
              item.quantity
            }" min="0" data-index="${index}" /></td>
            <td>Rp ${total.toLocaleString()}</td>
          `;

          cartTableBody.appendChild(row);
          subtotal += total;
        });

        // Update totals
        const totalElement = document.querySelector("#subtotal table");
        totalElement.innerHTML = `
          <tr>
            <td>Subtotal</td>
            <td>Rp ${subtotal.toLocaleString()}</td>
          </tr>
          <tr>
            <td>Shipping</td>
            <td>Free</td>
          </tr>
          <tr>
            <td><strong>Total</strong></td>
            <td><strong>Rp ${subtotal.toLocaleString()}</strong></td>
          </tr>
        `;

        // Add event listeners for delete buttons
        document.querySelectorAll(".delete-row").forEach((button) => {
          button.addEventListener("click", function (event) {
            event.preventDefault(); // Prevent default link behavior

            const index = this.getAttribute("data-index");
            deleteCartItem(index);
            updateCart(); // Update the cart display
          });
        });

        // Add event listeners for quantity inputs
        document.querySelectorAll("input[type='number']").forEach((input) => {
          input.addEventListener("input", function () {
            const index = this.getAttribute("data-index");
            const newQuantity = parseInt(this.value, 10);

            if (newQuantity < 0) {
              this.value = 0;
            }

            updateCartQuantity(index, newQuantity);
            updateCart(); // Update the cart display
          });
        });
      }

      function deleteCartItem(index) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.splice(index, 1); // Remove item at the specified index
        localStorage.setItem("cart", JSON.stringify(cart)); // Save updated cart
      }

      function updateCartQuantity(index, newQuantity) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        if (newQuantity <= 0) {
          cart.splice(index, 1); // Remove item if quantity is 0 or less
        } else {
          cart[index].quantity = newQuantity;
        }
        localStorage.setItem("cart", JSON.stringify(cart)); // Save updated cart
      }

      document.addEventListener("DOMContentLoaded", updateCart);

      document
        .querySelector("#add-cart .button")
        .addEventListener("click", function () {
          alert("Checkout complete!");
          localStorage.removeItem("cart"); // Clear the cart
          updateCart(); // Update the cart to reflect changes
        });
    </script>
  </body>
</html>
